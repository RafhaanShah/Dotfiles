### loads other cli tools

# asdf: language version manager
# https://github.com/asdf-vm/asdf
if [ -f "${HOME}/.asdf/asdf.sh" ]; then
    export ASDF_DIR="${HOME}/.asdf"
    _load_file "${ASDF_DIR}/asdf.sh" # load asdf
    _is_bash && _load_file "${ASDF_DIR}/completions/asdf.bash" # asdf bash completions
    _is_zsh && _add_to_fpath "${ASDF_DIR}/completions" # asdf zsh completions
fi

# bat: better cat
# https://github.com/sharkdp/bat
if _command_exists "bat"; then
    export BAT_PAGER='less -RF'
    alias cat='bat'
    alias cat-plain='bat --plain'
    alias cat-nopage='bat --plain --paging=never'
fi

# fd: better find
# https://github.com/sharkdp/fd
if _command_exists "fd"; then
    unset -f ffile
    alias ffile='fd'
fi

# lsd: ls with icons https://github.com/Peltoche/lsd
# needs a patched font, e.g: hack-nerd-font https://github.com/ryanoasis/nerd-fonts
# on iTerm2, set 'non-ascii font'
if _command_exists "lsd"; then
    alias ls='lsd --group-dirs first'
    unset -f tree
    tree() {
        if [ "$#" -eq 0 ]; then
            lsd --group-dirs first --tree --depth 2
        else
            lsd --group-dirs first --tree --depth "$@"
        fi
    }
fi

# set NPM global path to workaround permission issues
# https://docs.npmjs.com/resolving-eacces-permissions-errors-when-installing-packages-globally
if _command_exists "lsd"; then
    command mkdir -p "${HOME}/.npm-global"
    export NPM_CONFIG_PREFIX="${HOME}/.npm-global"
fi

# ripgrep: better grep
# https://github.com/burntsushi/ripgrep
if _command_exists "rg"; then
    unset -f ftext
    alias ftext='rg'
fi

# vivid: generate LS_COLORS https://github.com/sharkdp/vivid
if _command_exists "vivid"; then
    if _true_colour; then
        export LS_COLORS="$(vivid generate "${DOTFILE_DIR}/vivid/monokai.yml")"
    elif _256_colour; then
        export LS_COLORS="$(vivid -m 8-bit generate "${DOTFILE_DIR}/vivid/monokai.yml")"
    fi
fi
